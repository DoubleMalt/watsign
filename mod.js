// src/wat/sign.deno.wat.js
import { wrap } from "https://raw.githubusercontent.com/mitschabaude/watever/main/watever-js-wrapper/wrap.js";

// src/crypto.js
function randomBytes(n) {
  return crypto.getRandomValues(new Uint8Array(n));
}
async function hashNative(msg) {
  return new Uint8Array(await crypto.subtle.digest("SHA-512", msg));
}

// src/wat/sign.deno.wat.js
import { addLock, removeLock } from "https://raw.githubusercontent.com/mitschabaude/watever/main/watever-js-wrapper/wrap.js";
var wasm = "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IAEQJSACIAIgChAoIAMgACAAQYABahAkIAogASABQYABahAkIAMgAyAKECggBCAAQYADaiABQYADahAoIAQgBCMLECggBSAAQYACaiABQYACahAoIAUgBSAFECQgBiADIAIQJSAHIAUgBBAlIAggBSAEECQgCSADIAIQJCAAIAYgBxAoIABBgAFqIAkgCBAoIABBgAJqIAggBxAoIABBgANqIAYgCRAoCycBAX9BACEDA0AgACADaiABIANqIAIQKUGABCADQYABaiIDRw0ACwtRAQN/QYAMEBEhAiACQYAEaiEDIANBgARqIQQgBCABQYACahAwIAIgASAEECggAyABQYABaiAEECggACADEC0gACAALQAfIAIQLkEHdHM6AB8LqwIBB39BgAcQICECIAJBgAFqIQMgA0GAAWohBCAEQYABaiEFIAVBgAFqIQYgBkGAAWohByAHQYABaiEIIABCATwAgAIgAEGAAWogARAqIAQgAEGAAWoQJiAFIAQjChAoIAQgBCAAQYACahAlIAUgAEGAAmogBRAkIAYgBRAmIAcgBhAmIAggByAGECggAiAIIAQQKCACIAIgBRAoIAIgAhA3IAIgAiAEECggAiACIAUQKCACIAIgBRAoIAAgAiAFECggAyAAECYgAyADIAUQKCADIAQQKwRAIAAgACMOECgLIAMgABAmIAMgAyAFECggAyAEECsEQEF/DwsgAkGAARAhIAAQLiABLQAfQQd1RgRAIAAgAiAAECULIABBgANqIAAgAEGAAWoQKEEAC00BAn9BgAEQESECIAIgARAvQfoBIQMDQCACIAIQJiACIAIgARAoQQEgA0EBayIDRw0ACyACIAIQJiACIAIQJiACIAIgARAoIAAgAhAvCx4BAX9BgAQQICIBIABBwAAQIyAAIAEQOSAAQSAQFQv0AgMBfgN/An5B+AMhAwNAQgAhAiABIANqKQMAIQYgA0GAAmshBCADQeAAayEFA0AgASAEaikDACIHIAJCECAGfiAEIANrQYACaiMPaikDAH59fCIHQoABfEIIhyECIAcgAkKAAn59IQcgASAEaiAHNwMAIAUgBEEIaiIERw0ACyABIARqIAEgBGopAwAgAnw3AwAgASADakIANwMAQfgBIANBCGsiA0cNAAtCACECIAEpA/gBQgSHIQZBACEEA0AgASAEaikD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";
var { scalarbasePack, signPt2, reduce, verify, newKeyPair, keyPairFromSecretKey, keyPairFromSeed, table, memory, alloc, reset } = wrap(wasm, ["scalarbasePack#lift", "signPt2#lift", "reduce#lift", "verify#lift", "newKeyPair#lift", "keyPairFromSecretKey#lift", "keyPairFromSeed#lift", "table", "memory", "alloc", "reset"], { "#crypto": { "hashNative#lift": hashNative, "randomBytes": randomBytes }, "watever-js-wrapper": { "addLock": addLock, "removeLock": removeLock }, "js": { "console.log": "console.log", "s => {throw Error(s);}#lift": "s => {throw Error(s);}", "(p, c, ...args) => p.then(x => c(x, ...args))#lift": "(p, c, ...args) => p.then(x => c(x, ...args))" } });

// src/util.js
function checkArrayTypes(...args) {
  if (!args.every((arg) => arg instanceof Uint8Array)) {
    throw new TypeError("unexpected type, use Uint8Array");
  }
}
function concat(...arrays) {
  if (!arrays.length)
    return new Uint8Array();
  let totalLength = arrays.reduce((acc, value) => acc + value.length, 0);
  let result = new Uint8Array(totalLength);
  let length = 0;
  for (let array of arrays) {
    result.set(array, length);
    length += array.length;
  }
  return result;
}

// src/nacl-sign.deno.js
async function sign(msg, secretKey) {
  checkArrayTypes(msg, secretKey);
  if (secretKey.length !== 64)
    throw new Error("bad secret key size");
  let secret = secretKey.subarray(0, 32);
  let publicKey = secretKey.subarray(32);
  let secretHash = await hashNative(secret);
  let secretScalar = secretHash.subarray(0, 32);
  let nonceSeed = secretHash.subarray(32);
  let toBeHashed = new Uint8Array(64 + msg.byteLength);
  toBeHashed.set(nonceSeed, 32);
  toBeHashed.set(msg, 64);
  let nonce = await hashNative(toBeHashed.subarray(32));
  nonce = await reduce(nonce);
  let noncePoint = await scalarbasePack(nonce);
  toBeHashed.set(noncePoint);
  toBeHashed.set(publicKey, 32);
  let bigHash = await hashNative(toBeHashed);
  let sig = await signPt2(nonce, secretScalar, bigHash);
  return concat(noncePoint, sig);
}
export {
  keyPairFromSecretKey,
  keyPairFromSeed,
  newKeyPair,
  sign,
  verify
};
